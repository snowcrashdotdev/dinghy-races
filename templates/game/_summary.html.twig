{% set dashboard = dashboard|default(false) %}

{% set game_show = path('game_show', { 'name': game.name }) %}

{% set score_show = tournament ?
    path('score_show', {
        'game_name': game.name,
        'tournament_id': tournament.id
    }) :
    path('pb_show', {
        'game': game.name
    })
%}

{% set score_new = tournament ?
    path('score_new', {
        'game_name': game.name,
        'tournament_id': tournament.id
    }) :
    path('pb_new', {
        'game': game.name
    })
%}

<article class="game-summary">
    {% if game.marquee %}
        {% import '_macros/img.responsive.html.twig' as m_img %}
        {% set img_config = {
            'path': asset('/uploads/marquees/'),
            'file': game.marquee,
            'sizes': '(min-width: 42rem) 20rem, 100vw',
            'classNames': 'marquee'
        } %}

        {{ m_img.responsive(img_config) }}
    {% endif %}
    <h3>
        <a href="{{score_show}}">{{game.description}}</a>
        <br><small>{{game.manufacturer}}, {{game.year}}</small>
    </h3>
    {% if dashboard and user_score  %}
        <p class="color-three text-center">{{'#' ~ user_score.rank}}</p>
        <p class="roboto text-larger outlined text-center">{{user_score.points|number_format}}</p>
    {% elseif dashboard %}
        <p class="text-center text-large outlined"><a href="{{score_new}}">Add a score.</a></p>
    {% elseif high_score %}
        <p class="color-three text-center uppercase">High Score</p>
        <p class="roboto text-larger outlined text-center">{{high_score.points|number_format}}</p>
        {% if not app.request.get('_route') is same as('profile_show') %}
            <p class="text-center">{{high_score.user.username}}</p>
        {% endif %}
    {% else %}
        <p class="text-center text-large outlined">No scores.</p>
    {% endif %}

    <p class="text-small"><a href="{{game_show}}">Game info.</a></p>
</article>