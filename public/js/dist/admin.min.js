function addGameToCollection(json,resultList){let gameCollection=document.getElementById("game_collection_games"),prototype=gameCollection.getAttribute("data-prototype"),gamePreviews=document.getElementById("game-form-list");for(let result of json){let li=document.createElement("li");li.classList.add("ajax-search-result"),li.classList.add("game-search-result"),li.innerHTML=`${result.description} <small>(${result.name}.zip)</small>`,resultList.appendChild(li),li.addEventListener("click",(function(e){if(!confirm(`Add the game ${result.description} to this tournament?`))return!1;let gameCollectionPlaceholder=document.getElementById("game-form-no-items");gameCollectionPlaceholder&&gameCollectionPlaceholder.remove();let lastGame=gameCollection.lastElementChild,name=lastGame?getNewGameIndex(lastGame):0,newMarkup=prototype.replace(new RegExp("__name__","g"),name),newInput=document.createRange().createContextualFragment(newMarkup);gameCollection.appendChild(newInput),gameCollection.lastElementChild.value=result.name;let newPreview=document.createElement("span");newPreview.classList.add("game-form-list-item"),newPreview.setAttribute("data-input-id",gameCollection.lastElementChild.id),newPreview.innerText=result.name,newPreview.addEventListener("click",removeGameFromCollection),gamePreviews.appendChild(newPreview),resultList.previousElementSibling.value=""}))}}function removeGameFromCollection(event){let gamePreview=event.target,hiddenInput=document.getElementById(gamePreview.getAttribute("data-input-id"));if(hiddenInput){if(!0===confirm("Do you want to remove this game?")){let gameCollection=gamePreview.parentElement;if(gamePreview.remove(),hiddenInput.value=null,gameCollection.children.length<1){let gameCollectionPlaceholder=document.createElement("p");gameCollectionPlaceholder.id="game-form-no-items",gameCollectionPlaceholder.innerText="No games selected.",gameCollection.appendChild(gameCollectionPlaceholder)}}}}function getNewGameIndex(el){return Number(el.id.split("_").slice(-1))+1}document.addEventListener("DOMContentLoaded",(function(){let gameCollectionItems=document.getElementsByClassName("game-form-list-item");for(let item of gameCollectionItems)item.addEventListener("click",removeGameFromCollection)}));